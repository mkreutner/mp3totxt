 Salut à tous, c'est Florian de EtiConnect dans cette vidéo, je vais vous présenter l'outil NSLCUP, puisque je considère qu'il faut le connaître absolument quand on travaille en tant qu'administrateur système et réseau technici informatique ou ce que vous voulez vraiment dans l'informatique au sens large, il fait partie pour moi en même titre que la commande ping, tracerre, etc. et bien la commande NSLCUP est à connaître et donc c'est pour ça que je souhaite vous la présenter dans une vidéo. Alors aujourd'hui je vous passe évitue une petite slide pour vous présenter l'outil NSLCUP et à plomber partir à une session 100% des mots, je vais vous montrer comment l'utiliser au travers de différents exemples et on verra aussi qu'il y a maintenant un équivalent un petit peu plus moderne via PowerShell avec la commande Resolve DNS Nail. Alors si vous souhaitez en savoir plus, il bien n'hésitez pas à regarder la suite de la vidéo, mais avant cela pensez à vous abonner à la chaîne YouTube. Qu'est-ce que l'outil NSLCUP est bien, c'est un outil que l'on va utiliser en ligne de commande qui est intégré nativement dans Windows et que l'on peut également utiliser sur d'autres systèmes comme Linux, donc sur Linux il faudra installer un paquet supplémentaire et il va nous servir à interroger les serveurs DNS donc pour obtenir des informations sur les zones DNS, que ce soit la zone DNS publique par exemple la zone DNS de ITConnect.fr ou la zone DNS d'un domaine active directory, ça pourrait être le domaine ITConnect.local que j'utilise pour mon lab. L'outil NSLCUP va nous être utile lorsque l'on va faire face à une problématique liée au DNS, donc à de la résolution de nom. Par exemple vous avez un problème de DNS, un problème de résolution de nom sur votre infrastructure où verra un site que vous venez de mettre en ligne par exemple. Et bien vous allez pouvoir diagnostiquer le problème DNS grâce à NSLCUP, donc il fait vraiment faire partie de votre boîte à outils de 6anmin et on va pouvoir aussi bien avec NSLCUP vérifier tout simplement un enregistrement DNS. On peut imaginer que l'on vient de faire une modification dans la zone DNS d'un domaine et bien on va pouvoir avec NSLCUP interroger le serveur DNS pour voir si le changement a bien été pris en compte et on va pouvoir en fait avec NSLCUP interroger le serveur DNS que l'on souhaite donc ça c'est également pratique. Et puis comme je disais on verra également comment utiliser la commande resolve DNSName qui va nous permettre de faire la même chose qu'avec que NSLCUP si ce n'est qu'on va utiliser PowerShell. Nous allons maintenant voir comment utiliser NSLCUP que ce soit sur du Windows Server Windows 10 ou Windows 11 ou autre, ça se utilise exactement de la même façon. Donc vous ouvrez soit une invite de commande ou une console Windows PowerShell ou PowerShell qui vous faut c'est une console. Et après vous avez accès à la commande NSLCUP puisque le outil est intérêt à Windows. Ensuite on va donc mettre NSLCUP suivi éventuellement d'options pour personnaliser notre requête à destination du serveur DNS suivi de l'adresse IP ou du nombre de domaines en fonction de ce que l'on cherche à faire à vérifier. Donc ici je peux faire simplement NSLCUP Google.fr et là il me dit quoi ? Bien Google.fr adresse donc j'ai l'adresse IP V6 du domaine Google.fr et l'adresse IP V4. Alors vu que ces Google.fr que c'est quelque chose qui est redistribué et avec lequel il y a beaucoup de serveurs, l'adresse IP vous avez ici pour avaler d'une machine à une autre. Mais voilà, si vous faites ce même test sur votre blog personnel par exemple vous verrez que vous allez avoir l'adresse IP public de votre hébergement ou de votre box si vous l'ébergiez à la maison. Et ici on peut voir serveur localhost adresse 117001. En fait ça c'est le serveur DNS qui a été interrogé pour obtenir l'information qui est retournée ici par NSLCUP. Alors pourquoi 117001 ? Bien en fait je suis sur un contrôleur de domaines et du coup c'est interrogé lui-même pour résoudre le nom puisqu'il est lui-même serveur DNS. Si j'ai fait que le même test depuis l'on pose de travail, la valeur ici est devenue 4x1 puisque c'est le serveur DNS qui est configuré au niveau de mon interface réseau qui est utilisé pour accéder à internet. En l'occurrence ici ma carte réseau sans fil, on peut voir serveur DNS 4x1. C'est pour ça qu'en fait NSLCUP va interroger le serveur DNS qui est configuré au niveau de votre interface réseau. On verra après qu'on peut solliciter le serveur DNS de son choix en modifiant la syntaxe de la commande. Ce que l'on va pouvoir faire également c'est faire la résolution inversée, c'est à dire qu'on va préciser par exemple une adresse IP, donc 4x9 et on obtiendra le nom qui correspond. Donc là on peut chercher de cette manière à vérifier le bon fonctionnement d'une zone DNS de recherche inversée donc j'avais fait une vidéo sur ce principe-là et après nous allons pouvoir faire des requêtes NSLCUP un peu plus évolués on va dire où on va venir préciser ici des options. Par exemple nous avons le tiret type qui ne permet de préciser un type dans l'engagement DNS, on peut aller consulter le S1 de ITConnect.tech qui est mon domaine utilisé pour les lab et on va voir ici qu'on va obtenir des informations sur le S1, c'est start off autoritie, on va savoir par exemple que le serveur DNS primaire de ce domaine là, c'est un serveur chez OVH, on a aussi d'autres informations comme le TTL par défaut, donc la durée de vie par défaut des enregistrements sur cette zone DNS et on va pouvoir vérifier qu'en fait le serveur DNS qui fait autorité sur cette zone, c'est bien celui-ci, on a donc consulter l'orgistrement de type NS et on a bien ici donc réponse ne faisant pas autorité donc c'est parce que voilà mon serveur DNS que j'ai sollicité ici s'est appuyé sur un autre serveur pour obtenir l'information et il me dit bien ici et tconnect.tech et donc c'est bien NS104 et DNS104 au niveau des NM serveurs qui sont déclarés dans la zone DNS et on va pouvoir comme ça et bien parcourir les enregistrements de différents types je pourrais aussi aller lire la partie emix donc là ça me donnera des informations sur la partie messagerie je sais ici que le serveur de messagerie qui est déclaré sur ce domaine et bien c'est cette valeur là, cette valeur là c'est quoi typiquement ça correspond à de l'Office 365, à du Microsoft 365 et c'est bien le cas pour mon domaine IT.tech.com. Donc on aura comme ça accès à tous les types d'enregistrements, les enregistrements de types ressources également comme le TXT ou l'en à la lecture et bien de l'enregistrement SPF de ce domaine et on a une commande qui va nous permettre en quelque sorte dénumérer la zone DNS IT.tech ou Google.fm au ce que vous voulez en fait ça va consister ici à préciser le type enit en précisant le type enit on va vraiment obtenir l'intégralité des informations qui sont dans la zone alors même si j'ai constaté parfois qui pouvait en manquer mais on va retrouver bien en fait l'enregistrement émix, les enregistrements TXT, le DNS, le S1 on va vraiment tout retrouver ici donc c'est quand même assez intéressant pour faire de l'ennumération DNS même si on peut avoir des outils qui peuvent être un petit peu plus adaptés pour ça comme DNS et NUM ou sur Linux on aura dig. Dans certains cas quand on fait ce type de requête on peut avoir une erreur qui suffitiquement je vais vouloir faire avec en mettant ici donc le... En fait c'est si on met ici à la fin de la commande par exemple 4x1 ça veut dire que NSTookup pour résoudre, enfin pour exécuter ces 3quêtes DNS là il va solliciter le serveur 4x1 donc en fait c'est comme ça qu'on précise un serveur DNS différent et on voit en fait que si on sollicite le DNS de Cloudflare lui me dit sur la requête de type enit que c'est non implementé donc c'est pour ça que le enit fonctionne pas avec tout le monde avec le 4x8 de chez Google ça fonctionne donc voilà donc c'est la petite astuce si jamais vous êtes confronté à cet erreur là sachant que vous avez toujours le choix de spécifier le serveur DNS que vous souhaitez utiliser en l'indiquant à la fin de la ligne de commande NSTookup. Zollon pouvoir aussi et comme là c'est un environnement active directory listé les contrôleurs de domaines de ce domaine active directory donc on peut tout simplement faire un NSTookup suivi du nom de domain active directory et on voit ici que pour le nom de domain IT Connect pour lequel j'ai deux adressipés qui sont retournés ce sont les deux adressipés de mes contrôleurs de domaines et pour avoir une liste un peu plus précise on va les consulter un enregistrement de type et servez donc qui sera dans la zone IT Connect pour un local donc au niveau du serveur DNS de mon contrôleurs de domaines et là nous aurons des informations plus précises puisqu'on aura un enregistrement qui sera retourné par contrôleurs de domaines on voit ici que j'ai un premier enregistrement avec le nom SRVT reddds-01 donc c'est mon premier contrôleur de domaines et si j'ai mon deuxième et à la fin j'ai un résumé avec la liste donc le nom de chaque contrôleurs de domaines et son adressipé donc ça c'est plutôt intéressant et si vous voyez que vous avez des problèmes de résolution non dans votre environnement et que peut-être que votre contrôleurs de domaines n'apparaient pas bien dans cette liste ça peut vous donner des pistes derrière en plus c'est bien d'aller utiliser le ping d'aller checker l'observateur d'événements des contrôleurs de domaines et l'utiliser différentes commandes notamment décédiaillées. Sachez également qu'il y a un mode interactif avec DNS clocup donc suffit de faire DNS clocup et après vous êtes en mode interactif donc vous pouvez rentrer directement vos commandes ici faire des définir des paramètres directement ici ce sera pris en charge au niveau de la session et n'explique en quelque sorte donc ça c'est une autre manière de l'utiliser personnellement je utilise plutôt la méthode voilà basée sur les commandes comme je vous l'ai montré à l'instant. Les armées nous allons voir la commande résolve tirée DNS Nail c'est en quelque sorte un équivalent de DNS clocup mais au niveau de pauvres chats ça s'utilise assez facilement on est pas on est peu près dans le même esprit on va dire que NS clocup on peut très bien faire un résultat d'NSS Nail de Google point et faire et là on aura donc le résultat qui nous retourne par défaut les organistrements donc deux types qu'à fois à IPv6 et de type A IPv4 je pourrais très bien rappeler la commande et mettre un type A et là j'ai que l'organistrement de type A donc on va pouvoir au même type qu'on l'a fait avec NS clocup à les consulter les organistrements de différents types je pourrais le faire avec le MX voilà au niveau des MX de Google voilà ce qui est retourné ce qui va être intéressant avec résolve DNS Nail si qu'on va travailler en pauvres chats on va avoir en retour et bien on peut voir un objet pour au cher avec différentes propriétés donc ce sera beaucoup plus facile d'aller récupérer par exemple l'adresse IP le type d'enregistrement ce sera beaucoup plus facile d'aller d'exploiter les données que l'on va récupérer plutôt qu'avec NS clocup et en fait vu que ça reste du pauvres chats on peut intégrer résolve DNS Nail très facilement dans un script pour faire des vérifications x ou y. On a également la possibilité de spécifier un serveur DNS personnalisé en mettant tirer le serveur et là on précise le serveur DNS que l'on veut interroger pour obtenir l'orgistrement MX de Google pour les faire voilà et on obtient bien la réponse via ce serveur DNS on y a d'autres options sympas comme par exemple le tirer cache on y qui va permettre d'aller d'aller lire l'information uniquement dans le cache DNS local de la machine donc c'est à dire que là on ne va pas chercher l'information sur le serveur DNS externe on va lire l'information dans le cache de la machine donc là on voit que ça m'a retourné des informations donc si je fais un clear DNS client cache voilà où je pure mon cache local au niveau DNS et si je fais ça du coup il me dit pour gistrement DNS n'est d'y ce pas puisque mon cache a été vide donc là on voit bien qu'il s'appuie uniquement sur le cache local de la machine le dernier exemple que je souhaiteais vous montrer c'est que l'on peut indiquer plusieurs noms de d'autres en entrée et demander la résolution non on peut aussi aller chercher cette liste dans un fichier on peut pas en faire Google.com, Google.fr comme ceci et là on va faire un résol DNS Nail type A par exemple si on veut les registrément de type A et j'ai bien l'information pour chaque nombre de mènes avec à chaque fois le type et l'adresse IP correspondant. On pourrait faire aussi une commente un peu hybrid où on va en fait utiliser DNS tuke up avec PowerShell on va dire donc là ce qu'on peut faire c'est une boucle for rich pour parcourir à bien chaque valeur de la liste qui sera envoyé en entrée via le pipeline et en fait ici on va faire un DNS tuke up on va préciser tirer taille égal A si on veut bien avoir un les registrément de type A et vraiment faire un équivalent de la commande qui est au-dessus et on va appeler la variable automatique comme ceci et là j'ai bien à chaque fois et bien tout d'abord un premier retour NS tuke up pour Google.com puis un second retour NS tuke up pour Google.fr on a fait une sorte de commande hybrid qui fait à la fois du PowerShell et qui appelle l'outil NS tuke up voilà cette vidéo est terminée j'espère que ça vous a plu vous avez peut-être découvert la version PowerShell entre guillemets de NS tuke up via la commande resolve tirer des NS nays j'espère que cette vidéo vous a plu n'hésitez pas à commenter à liker et à partager au max je vous dis à très vite ciao